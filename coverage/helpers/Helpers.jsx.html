
<!doctype html>
<html lang="en">

<head>
    <title>Code coverage report for helpers/Helpers.jsx</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
    
<body>
<div class='wrapper'>
    <div class='pad1'>
        <h1><a href="../index.html">All files</a> / <a href="index.html">helpers</a> Helpers.jsx</h1>
        <div class='clearfix'>
            
            <div class='fl pad1y space-right2'>
                <span class="strong">24.7% </span>
                <span class="quiet">Statements</span>
                <span class='fraction'>63/255</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">100% </span>
                <span class="quiet">Branches</span>
                <span class='fraction'>3/3</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">16.66% </span>
                <span class="quiet">Functions</span>
                <span class='fraction'>1/6</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">24.7% </span>
                <span class="quiet">Lines</span>
                <span class='fraction'>63/255</span>
            </div>
        
            
        </div>
        <p class="quiet">
            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
        </p>
        <template id="filterTemplate">
            <div class="quiet">
                Filter:
                <input oninput="onInput()" type="search" id="fileSearch">
            </div>
        </template>
    </div>
    <div class='status-line low'></div>
    <pre><table class="coverage">
<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
<a name='L2'></a><a href='#L2'>2</a>
<a name='L3'></a><a href='#L3'>3</a>
<a name='L4'></a><a href='#L4'>4</a>
<a name='L5'></a><a href='#L5'>5</a>
<a name='L6'></a><a href='#L6'>6</a>
<a name='L7'></a><a href='#L7'>7</a>
<a name='L8'></a><a href='#L8'>8</a>
<a name='L9'></a><a href='#L9'>9</a>
<a name='L10'></a><a href='#L10'>10</a>
<a name='L11'></a><a href='#L11'>11</a>
<a name='L12'></a><a href='#L12'>12</a>
<a name='L13'></a><a href='#L13'>13</a>
<a name='L14'></a><a href='#L14'>14</a>
<a name='L15'></a><a href='#L15'>15</a>
<a name='L16'></a><a href='#L16'>16</a>
<a name='L17'></a><a href='#L17'>17</a>
<a name='L18'></a><a href='#L18'>18</a>
<a name='L19'></a><a href='#L19'>19</a>
<a name='L20'></a><a href='#L20'>20</a>
<a name='L21'></a><a href='#L21'>21</a>
<a name='L22'></a><a href='#L22'>22</a>
<a name='L23'></a><a href='#L23'>23</a>
<a name='L24'></a><a href='#L24'>24</a>
<a name='L25'></a><a href='#L25'>25</a>
<a name='L26'></a><a href='#L26'>26</a>
<a name='L27'></a><a href='#L27'>27</a>
<a name='L28'></a><a href='#L28'>28</a>
<a name='L29'></a><a href='#L29'>29</a>
<a name='L30'></a><a href='#L30'>30</a>
<a name='L31'></a><a href='#L31'>31</a>
<a name='L32'></a><a href='#L32'>32</a>
<a name='L33'></a><a href='#L33'>33</a>
<a name='L34'></a><a href='#L34'>34</a>
<a name='L35'></a><a href='#L35'>35</a>
<a name='L36'></a><a href='#L36'>36</a>
<a name='L37'></a><a href='#L37'>37</a>
<a name='L38'></a><a href='#L38'>38</a>
<a name='L39'></a><a href='#L39'>39</a>
<a name='L40'></a><a href='#L40'>40</a>
<a name='L41'></a><a href='#L41'>41</a>
<a name='L42'></a><a href='#L42'>42</a>
<a name='L43'></a><a href='#L43'>43</a>
<a name='L44'></a><a href='#L44'>44</a>
<a name='L45'></a><a href='#L45'>45</a>
<a name='L46'></a><a href='#L46'>46</a>
<a name='L47'></a><a href='#L47'>47</a>
<a name='L48'></a><a href='#L48'>48</a>
<a name='L49'></a><a href='#L49'>49</a>
<a name='L50'></a><a href='#L50'>50</a>
<a name='L51'></a><a href='#L51'>51</a>
<a name='L52'></a><a href='#L52'>52</a>
<a name='L53'></a><a href='#L53'>53</a>
<a name='L54'></a><a href='#L54'>54</a>
<a name='L55'></a><a href='#L55'>55</a>
<a name='L56'></a><a href='#L56'>56</a>
<a name='L57'></a><a href='#L57'>57</a>
<a name='L58'></a><a href='#L58'>58</a>
<a name='L59'></a><a href='#L59'>59</a>
<a name='L60'></a><a href='#L60'>60</a>
<a name='L61'></a><a href='#L61'>61</a>
<a name='L62'></a><a href='#L62'>62</a>
<a name='L63'></a><a href='#L63'>63</a>
<a name='L64'></a><a href='#L64'>64</a>
<a name='L65'></a><a href='#L65'>65</a>
<a name='L66'></a><a href='#L66'>66</a>
<a name='L67'></a><a href='#L67'>67</a>
<a name='L68'></a><a href='#L68'>68</a>
<a name='L69'></a><a href='#L69'>69</a>
<a name='L70'></a><a href='#L70'>70</a>
<a name='L71'></a><a href='#L71'>71</a>
<a name='L72'></a><a href='#L72'>72</a>
<a name='L73'></a><a href='#L73'>73</a>
<a name='L74'></a><a href='#L74'>74</a>
<a name='L75'></a><a href='#L75'>75</a>
<a name='L76'></a><a href='#L76'>76</a>
<a name='L77'></a><a href='#L77'>77</a>
<a name='L78'></a><a href='#L78'>78</a>
<a name='L79'></a><a href='#L79'>79</a>
<a name='L80'></a><a href='#L80'>80</a>
<a name='L81'></a><a href='#L81'>81</a>
<a name='L82'></a><a href='#L82'>82</a>
<a name='L83'></a><a href='#L83'>83</a>
<a name='L84'></a><a href='#L84'>84</a>
<a name='L85'></a><a href='#L85'>85</a>
<a name='L86'></a><a href='#L86'>86</a>
<a name='L87'></a><a href='#L87'>87</a>
<a name='L88'></a><a href='#L88'>88</a>
<a name='L89'></a><a href='#L89'>89</a>
<a name='L90'></a><a href='#L90'>90</a>
<a name='L91'></a><a href='#L91'>91</a>
<a name='L92'></a><a href='#L92'>92</a>
<a name='L93'></a><a href='#L93'>93</a>
<a name='L94'></a><a href='#L94'>94</a>
<a name='L95'></a><a href='#L95'>95</a>
<a name='L96'></a><a href='#L96'>96</a>
<a name='L97'></a><a href='#L97'>97</a>
<a name='L98'></a><a href='#L98'>98</a>
<a name='L99'></a><a href='#L99'>99</a>
<a name='L100'></a><a href='#L100'>100</a>
<a name='L101'></a><a href='#L101'>101</a>
<a name='L102'></a><a href='#L102'>102</a>
<a name='L103'></a><a href='#L103'>103</a>
<a name='L104'></a><a href='#L104'>104</a>
<a name='L105'></a><a href='#L105'>105</a>
<a name='L106'></a><a href='#L106'>106</a>
<a name='L107'></a><a href='#L107'>107</a>
<a name='L108'></a><a href='#L108'>108</a>
<a name='L109'></a><a href='#L109'>109</a>
<a name='L110'></a><a href='#L110'>110</a>
<a name='L111'></a><a href='#L111'>111</a>
<a name='L112'></a><a href='#L112'>112</a>
<a name='L113'></a><a href='#L113'>113</a>
<a name='L114'></a><a href='#L114'>114</a>
<a name='L115'></a><a href='#L115'>115</a>
<a name='L116'></a><a href='#L116'>116</a>
<a name='L117'></a><a href='#L117'>117</a>
<a name='L118'></a><a href='#L118'>118</a>
<a name='L119'></a><a href='#L119'>119</a>
<a name='L120'></a><a href='#L120'>120</a>
<a name='L121'></a><a href='#L121'>121</a>
<a name='L122'></a><a href='#L122'>122</a>
<a name='L123'></a><a href='#L123'>123</a>
<a name='L124'></a><a href='#L124'>124</a>
<a name='L125'></a><a href='#L125'>125</a>
<a name='L126'></a><a href='#L126'>126</a>
<a name='L127'></a><a href='#L127'>127</a>
<a name='L128'></a><a href='#L128'>128</a>
<a name='L129'></a><a href='#L129'>129</a>
<a name='L130'></a><a href='#L130'>130</a>
<a name='L131'></a><a href='#L131'>131</a>
<a name='L132'></a><a href='#L132'>132</a>
<a name='L133'></a><a href='#L133'>133</a>
<a name='L134'></a><a href='#L134'>134</a>
<a name='L135'></a><a href='#L135'>135</a>
<a name='L136'></a><a href='#L136'>136</a>
<a name='L137'></a><a href='#L137'>137</a>
<a name='L138'></a><a href='#L138'>138</a>
<a name='L139'></a><a href='#L139'>139</a>
<a name='L140'></a><a href='#L140'>140</a>
<a name='L141'></a><a href='#L141'>141</a>
<a name='L142'></a><a href='#L142'>142</a>
<a name='L143'></a><a href='#L143'>143</a>
<a name='L144'></a><a href='#L144'>144</a>
<a name='L145'></a><a href='#L145'>145</a>
<a name='L146'></a><a href='#L146'>146</a>
<a name='L147'></a><a href='#L147'>147</a>
<a name='L148'></a><a href='#L148'>148</a>
<a name='L149'></a><a href='#L149'>149</a>
<a name='L150'></a><a href='#L150'>150</a>
<a name='L151'></a><a href='#L151'>151</a>
<a name='L152'></a><a href='#L152'>152</a>
<a name='L153'></a><a href='#L153'>153</a>
<a name='L154'></a><a href='#L154'>154</a>
<a name='L155'></a><a href='#L155'>155</a>
<a name='L156'></a><a href='#L156'>156</a>
<a name='L157'></a><a href='#L157'>157</a>
<a name='L158'></a><a href='#L158'>158</a>
<a name='L159'></a><a href='#L159'>159</a>
<a name='L160'></a><a href='#L160'>160</a>
<a name='L161'></a><a href='#L161'>161</a>
<a name='L162'></a><a href='#L162'>162</a>
<a name='L163'></a><a href='#L163'>163</a>
<a name='L164'></a><a href='#L164'>164</a>
<a name='L165'></a><a href='#L165'>165</a>
<a name='L166'></a><a href='#L166'>166</a>
<a name='L167'></a><a href='#L167'>167</a>
<a name='L168'></a><a href='#L168'>168</a>
<a name='L169'></a><a href='#L169'>169</a>
<a name='L170'></a><a href='#L170'>170</a>
<a name='L171'></a><a href='#L171'>171</a>
<a name='L172'></a><a href='#L172'>172</a>
<a name='L173'></a><a href='#L173'>173</a>
<a name='L174'></a><a href='#L174'>174</a>
<a name='L175'></a><a href='#L175'>175</a>
<a name='L176'></a><a href='#L176'>176</a>
<a name='L177'></a><a href='#L177'>177</a>
<a name='L178'></a><a href='#L178'>178</a>
<a name='L179'></a><a href='#L179'>179</a>
<a name='L180'></a><a href='#L180'>180</a>
<a name='L181'></a><a href='#L181'>181</a>
<a name='L182'></a><a href='#L182'>182</a>
<a name='L183'></a><a href='#L183'>183</a>
<a name='L184'></a><a href='#L184'>184</a>
<a name='L185'></a><a href='#L185'>185</a>
<a name='L186'></a><a href='#L186'>186</a>
<a name='L187'></a><a href='#L187'>187</a>
<a name='L188'></a><a href='#L188'>188</a>
<a name='L189'></a><a href='#L189'>189</a>
<a name='L190'></a><a href='#L190'>190</a>
<a name='L191'></a><a href='#L191'>191</a>
<a name='L192'></a><a href='#L192'>192</a>
<a name='L193'></a><a href='#L193'>193</a>
<a name='L194'></a><a href='#L194'>194</a>
<a name='L195'></a><a href='#L195'>195</a>
<a name='L196'></a><a href='#L196'>196</a>
<a name='L197'></a><a href='#L197'>197</a>
<a name='L198'></a><a href='#L198'>198</a>
<a name='L199'></a><a href='#L199'>199</a>
<a name='L200'></a><a href='#L200'>200</a>
<a name='L201'></a><a href='#L201'>201</a>
<a name='L202'></a><a href='#L202'>202</a>
<a name='L203'></a><a href='#L203'>203</a>
<a name='L204'></a><a href='#L204'>204</a>
<a name='L205'></a><a href='#L205'>205</a>
<a name='L206'></a><a href='#L206'>206</a>
<a name='L207'></a><a href='#L207'>207</a>
<a name='L208'></a><a href='#L208'>208</a>
<a name='L209'></a><a href='#L209'>209</a>
<a name='L210'></a><a href='#L210'>210</a>
<a name='L211'></a><a href='#L211'>211</a>
<a name='L212'></a><a href='#L212'>212</a>
<a name='L213'></a><a href='#L213'>213</a>
<a name='L214'></a><a href='#L214'>214</a>
<a name='L215'></a><a href='#L215'>215</a>
<a name='L216'></a><a href='#L216'>216</a>
<a name='L217'></a><a href='#L217'>217</a>
<a name='L218'></a><a href='#L218'>218</a>
<a name='L219'></a><a href='#L219'>219</a>
<a name='L220'></a><a href='#L220'>220</a>
<a name='L221'></a><a href='#L221'>221</a>
<a name='L222'></a><a href='#L222'>222</a>
<a name='L223'></a><a href='#L223'>223</a>
<a name='L224'></a><a href='#L224'>224</a>
<a name='L225'></a><a href='#L225'>225</a>
<a name='L226'></a><a href='#L226'>226</a>
<a name='L227'></a><a href='#L227'>227</a>
<a name='L228'></a><a href='#L228'>228</a>
<a name='L229'></a><a href='#L229'>229</a>
<a name='L230'></a><a href='#L230'>230</a>
<a name='L231'></a><a href='#L231'>231</a>
<a name='L232'></a><a href='#L232'>232</a>
<a name='L233'></a><a href='#L233'>233</a>
<a name='L234'></a><a href='#L234'>234</a>
<a name='L235'></a><a href='#L235'>235</a>
<a name='L236'></a><a href='#L236'>236</a>
<a name='L237'></a><a href='#L237'>237</a>
<a name='L238'></a><a href='#L238'>238</a>
<a name='L239'></a><a href='#L239'>239</a>
<a name='L240'></a><a href='#L240'>240</a>
<a name='L241'></a><a href='#L241'>241</a>
<a name='L242'></a><a href='#L242'>242</a>
<a name='L243'></a><a href='#L243'>243</a>
<a name='L244'></a><a href='#L244'>244</a>
<a name='L245'></a><a href='#L245'>245</a>
<a name='L246'></a><a href='#L246'>246</a>
<a name='L247'></a><a href='#L247'>247</a>
<a name='L248'></a><a href='#L248'>248</a>
<a name='L249'></a><a href='#L249'>249</a>
<a name='L250'></a><a href='#L250'>250</a>
<a name='L251'></a><a href='#L251'>251</a>
<a name='L252'></a><a href='#L252'>252</a>
<a name='L253'></a><a href='#L253'>253</a>
<a name='L254'></a><a href='#L254'>254</a>
<a name='L255'></a><a href='#L255'>255</a>
<a name='L256'></a><a href='#L256'>256</a></td><td class="line-coverage quiet"><span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">24x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import { htmlIdGenerator } from '@elastic/eui';
import ECS_FIELDS from './Ecs';
import axios from 'axios';
import { getEncoding } from 'js-tiktoken';
import { useGlobalState } from '../hooks/GlobalState';
import { OpenAIClient, AzureKeyCredential } from '@azure/openai';
&nbsp;
const esUser = import.meta.env.VITE_ES_USER;
const esPass = import.meta.env.VITE_ES_PASS;
const esHost = import.meta.env.VITE_ES_HOST;
&nbsp;
const aiEndpoint = import.meta.env.VITE_OPENAI_ENDPOINT;
const aiKey = import.meta.env.VITE_OPENAI_APIKEY;
const aiEngine = import.meta.env.VITE_OPENAI_ENGINE;
const aiTokenLimit = import.meta.env.VITE_OPENAI_TOKEN_LIMIT;
&nbsp;
const globalState = useGlobalState.getState();
&nbsp;
const examplePipeline = `{"processors":[{"json":{"field":"message","target_field":"mysqlenterprise.audit"}},{"remove":{"field":["message"]}},{"set":{"field":"event.kind","value":"event"}},{"append":{"field":"event.category","value":"database"}},{"append":{"field":"event.category","value":"network","if":"ctx?.mysqlenterprise?.audit?.event == 'connect'"}},{"append":{"field":"event.category","value":"iam","if":"['create_user', 'delete_user', 'drop_user', 'grant', 'flush_privileges'].contains(ctx.mysqlenterprise.audit?.general_data?.sql_command)"}},{"append":{"field":"event.type","value":"access","if":"ctx?.mysqlenterprise?.audit?.class != 'audit'"}},{"set":{"field":"event.outcome","value":"success","if":"ctx?.mysqlenterprise?.audit?.connection_data?.status != null &amp;&amp; ctx?.mysqlenterprise?.audit?.connection_data?.status == 0 || ctx?.mysqlenterprise?.audit?.general_data?.status != null &amp;&amp; ctx?.mysqlenterprise?.audit?.general_data?.status == 0"}},{"set":{"field":"event.outcome","value":"failure","if":"ctx?.mysqlenterprise?.audit?.connection_data?.status != null &amp;&amp; ctx?.mysqlenterprise?.audit?.connection_data?.status &gt; 0 || ctx?.mysqlenterprise?.audit?.general_data?.status != null &amp;&amp; ctx?.mysqlenterprise?.audit?.general_data?.status &gt; 0"}},{"set":{"field":"event.action","value":"mysql-{{ mysqlenterprise.audit.event }}","if":"ctx?.mysqlenterprise?.audit?.event != null"}},{"rename":{"field":"mysqlenterprise.audit.account.user","target_field":"server.user.name","ignore_missing":true}},{"rename":{"field":"mysqlenterprise.audit.account.host","target_field":"client.domain","ignore_missing":true}},{"rename":{"field":"mysqlenterprise.audit.login.os","target_field":"client.user.name","ignore_missing":true}},{"rename":{"field":"mysqlenterprise.audit.login.ip","target_field":"client.ip","ignore_missing":true}},{"rename":{"field":"mysqlenterprise.audit.startup_data.os_version","target_field":"host.os.full","ignore_missing":true}},{"rename":{"field":"mysqlenterprise.audit.startup_data.mysql_version","target_field":"service.version","ignore_missing":true}},{"rename":{"field":"mysqlenterprise.audit.startup_data.server_id","target_field":"service.id","ignore_missing":true}},{"rename":{"field":"mysqlenterprise.audit.startup_data.args","target_field":"process.args","ignore_missing":true}},{"set":{"field":"user.name","value":"{{server.user.name}}","ignore_empty_value":true,"if":"ctx.user?.target != null"}},{"append":{"field":"related.user","value":"{{server.user.name}}","allow_duplicates":false,"if":"ctx?.server?.user?.name != null"}},{"append":{"field":"related.user","value":"{{client.user.name}}","allow_duplicates":false,"if":"ctx?.client?.user?.name != null"}},{"append":{"field":"related.user","value":"{{user.target.name}}","allow_duplicates":false,"if":"ctx?.user?.target?.name != null"}},{"append":{"field":"related.ip","value":"{{client.ip}}","allow_duplicates":false,"if":"ctx?.client?.ip != null"}},{"append":{"field":"related.hosts","value":"{{client.domain}}","allow_duplicates":false,"if":"ctx?.client?.domain != null"}},{"date":{"field":"mysqlenterprise.audit.timestamp","formats":["yyyy-MM-dd HH:mm:ss"],"if":"ctx?.mysqlenterprise?.audit?.timestamp != null"}}]}`;
&nbsp;
const messages = [
  {
    role: 'system',
    content:
      'You are an AI assistant that helps people create Elasticsearch Ingest Pipelines based on user provided data which is a JSON string that is stored in the "message" field. Please provide a single codeblock on a single line containing a Ingest Pipeline and nothing else. The content from the user should include the vendor and product, and one or more JSON strings for example data to be transformed with the ingest pipeline.\nWhen creating the Ingest Pipeline, follow these rules:\nFirst use the JSON processor to process the JSON string in the message field. The configured target_field for the JSON processor should be the vendor and product, for example mysql.audit or microsoft.defender.\nAfter that you should use the remove processor to remove the message field.\nAfter that you should use the rename processor, on any field that matches the Elastic Common Schema, to rename the field and path to match the ECS schema. For example mysql.audit.username should be moved to user.name. Only use one rename processor per field, as it does not allow arrays.\nNever try to rename two fields to the same ECS field if they are in the same log sample, as it will overwrite eachother. If the user provides multiple log samples, and each has different fields that would result in the same ECS destination field then that is fine.\nIf you find any field that indicates the timestamp the event happened, use a date processor to parse this field into @timestamp.',
  },
  {
    role: 'user',
    content:
      'Vendor: MySQL Enterprise, Product: Audit\nTest Data: { "timestamp": "2020-10-19 19:31:47", "id": 0, "class": "general", "event": "status", "connection_id": 16, "account": { "user": "audit_test_user2", "host": "hades.home" }, "login": { "user": "audit_test_user2", "os": "", "ip": "192.168.2.5", "proxy": "" }, "general_data": { "command": "Query", "sql_command": "create_table", "query": "CREATE TABLE audit_test_table (firstname VARCHAR(20), lastname VARCHAR(20))", "status": 0 } }',
  },
  {
    role: 'assistant',
    content: '```' + examplePipeline + '```',
  },
];
&nbsp;
const makeId = htmlIdGenerator();
&nbsp;
export const calculateTokenCount = (textArray) =&gt; {
  let fullText = '';
&nbsp;
  messages.forEach((message) =&gt; {
    fullText += message.content + '\n';
  });
&nbsp;
  textArray.forEach((text) =&gt; {
    fullText += '\n' + text;
  });
&nbsp;
  const enc = getEncoding('cl100k_base');
  const tokens = enc.encode(fullText);
  return tokens.length;
};
&nbsp;
export const runPipeline = <span class="fstat-no" title="function not covered" >(ingestPipeline, messageArray) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >  let verbose = false;</span>
<span class="cstat-no" title="statement not covered" >  let url = '';</span>
<span class="cstat-no" title="statement not covered" >  if (ingestPipeline.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >    verbose = true;</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" >  if (verbose) {</span>
<span class="cstat-no" title="statement not covered" >    url = esHost + '/_ingest/pipeline/_simulate?verbose=true';</span>
<span class="cstat-no" title="statement not covered" >  } else {</span>
<span class="cstat-no" title="statement not covered" >    url = esHost + '/_ingest/pipeline/_simulate';</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" >  const result = {</span>
<span class="cstat-no" title="statement not covered" >    pipeline: {</span>
<span class="cstat-no" title="statement not covered" >      description: '',</span>
<span class="cstat-no" title="statement not covered" >      processors: [],</span>
<span class="cstat-no" title="statement not covered" >    },</span>
<span class="cstat-no" title="statement not covered" >    docs: [],</span>
<span class="cstat-no" title="statement not covered" >  };</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >  ingestPipeline.forEach((processor) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    let processedContent;</span>
<span class="cstat-no" title="statement not covered" >    if (typeof processor.content === 'string') {</span>
<span class="cstat-no" title="statement not covered" >      try {</span>
<span class="cstat-no" title="statement not covered" >        processedContent = JSON.parse(processor.content);</span>
<span class="cstat-no" title="statement not covered" >      } catch (e) {</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
<span class="cstat-no" title="statement not covered" >      }</span>
<span class="cstat-no" title="statement not covered" >    } else {</span>
<span class="cstat-no" title="statement not covered" >      // Create a deep copy of processor.content</span>
<span class="cstat-no" title="statement not covered" >      processedContent = JSON.parse(JSON.stringify(processor.content));</span>
<span class="cstat-no" title="statement not covered" >    }</span>
<span class="cstat-no" title="statement not covered" >    let rootField = Object.keys(processedContent)[0];</span>
<span class="cstat-no" title="statement not covered" >    processedContent[rootField]['tag'] = processor.key;</span>
<span class="cstat-no" title="statement not covered" >    result.pipeline.processors.push(processedContent);</span>
<span class="cstat-no" title="statement not covered" >  });</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >  messageArray.forEach((message, index) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    const doc = {</span>
<span class="cstat-no" title="statement not covered" >      _index: 'index',</span>
<span class="cstat-no" title="statement not covered" >      _id: `${index}`,</span>
<span class="cstat-no" title="statement not covered" >      _source: {</span>
<span class="cstat-no" title="statement not covered" >        message: message,</span>
<span class="cstat-no" title="statement not covered" >      },</span>
<span class="cstat-no" title="statement not covered" >    };</span>
<span class="cstat-no" title="statement not covered" >    result.docs.push(doc);</span>
<span class="cstat-no" title="statement not covered" >  });</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >  axios</span>
<span class="cstat-no" title="statement not covered" >    .post(url, result, {</span>
<span class="cstat-no" title="statement not covered" >      headers: {</span>
<span class="cstat-no" title="statement not covered" >        'Content-Type': 'application/json',</span>
<span class="cstat-no" title="statement not covered" >        Authorization: 'Basic ' + btoa(esUser + ':' + esPass),</span>
<span class="cstat-no" title="statement not covered" >      },</span>
<span class="cstat-no" title="statement not covered" >    })</span>
<span class="cstat-no" title="statement not covered" >    .then((response) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >      handleRunResults(response.data, verbose);</span>
<span class="cstat-no" title="statement not covered" >    })</span>
<span class="cstat-no" title="statement not covered" >    .catch((error) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >      console.log('response err: ', error);</span>
<span class="cstat-no" title="statement not covered" >    });</span>
<span class="cstat-no" title="statement not covered" >};</span>
&nbsp;
export const handleRunResults = <span class="fstat-no" title="function not covered" >(runResults, verbose) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >  if (!verbose) {</span>
<span class="cstat-no" title="statement not covered" >    const lastSuccessfulResults = runResults.docs.map((doc) =&gt; doc.doc._source);</span>
<span class="cstat-no" title="statement not covered" >    globalState.setPipelineRunResults(lastSuccessfulResults);</span>
<span class="cstat-no" title="statement not covered" >  } else if (verbose &amp;&amp; runResults.docs.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >    let lastSuccessfulResults = [];</span>
<span class="cstat-no" title="statement not covered" >    let errorDocIndices = [];</span>
<span class="cstat-no" title="statement not covered" >    let pipelineSteps = {};</span>
<span class="cstat-no" title="statement not covered" >    let pipelineSkippedSteps = {};</span>
<span class="cstat-no" title="statement not covered" >    let pipelineErrors = {};</span>
<span class="cstat-no" title="statement not covered" >    let pipelineStats = {};</span>
<span class="cstat-no" title="statement not covered" >    let successCount = 0;</span>
<span class="cstat-no" title="statement not covered" >    let errorCount = 0;</span>
<span class="cstat-no" title="statement not covered" >    let totalDuration = 0;</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >    runResults.docs.forEach((doc) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >      let lastSuccessfulResult = null;</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >      doc.processor_results.forEach((result, index) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        const { status, tag, doc: resultDoc } = result;</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >        if (status === 'success') {</span>
<span class="cstat-no" title="statement not covered" >          lastSuccessfulResult = resultDoc._source;</span>
<span class="cstat-no" title="statement not covered" >          if (!pipelineSteps[tag]) pipelineSteps[tag] = [];</span>
<span class="cstat-no" title="statement not covered" >          pipelineSteps[tag].push(resultDoc._source);</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >          successCount++;</span>
<span class="cstat-no" title="statement not covered" >          totalDuration += resultDoc._ingest.duration;</span>
<span class="cstat-no" title="statement not covered" >        } else if (status === 'skipped') {</span>
<span class="cstat-no" title="statement not covered" >          if (!pipelineSkippedSteps[tag]) pipelineSkippedSteps[tag] = [];</span>
<span class="cstat-no" title="statement not covered" >          const skippedResult = { ...result };</span>
<span class="cstat-no" title="statement not covered" >          if (doc.processor_results[index - 1]) {</span>
<span class="cstat-no" title="statement not covered" >            skippedResult.skipped_doc = doc.processor_results[index - 1].doc._source;</span>
<span class="cstat-no" title="statement not covered" >          }</span>
<span class="cstat-no" title="statement not covered" >          pipelineSkippedSteps[tag].push(skippedResult);</span>
<span class="cstat-no" title="statement not covered" >        } else {</span>
<span class="cstat-no" title="statement not covered" >          if (!pipelineErrors[tag]) pipelineErrors[tag] = [];</span>
<span class="cstat-no" title="statement not covered" >          pipelineErrors[tag].push(result);</span>
<span class="cstat-no" title="statement not covered" >          errorDocIndices.push(index);</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >          errorCount++;</span>
<span class="cstat-no" title="statement not covered" >        }</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >        const stats = {</span>
<span class="cstat-no" title="statement not covered" >          status: result.status,</span>
<span class="cstat-no" title="statement not covered" >          duration: result.status === 'success' ? resultDoc._ingest.duration : 0,</span>
<span class="cstat-no" title="statement not covered" >        };</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >        if (!pipelineStats[tag]) pipelineStats[tag] = [];</span>
<span class="cstat-no" title="statement not covered" >        pipelineStats[tag].push(stats);</span>
<span class="cstat-no" title="statement not covered" >      });</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >      lastSuccessfulResults.push(lastSuccessfulResult);</span>
<span class="cstat-no" title="statement not covered" >    });</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >    globalState.setPipelineSteps(pipelineSteps);</span>
<span class="cstat-no" title="statement not covered" >    globalState.setPipelineSkippedSteps(pipelineSkippedSteps);</span>
<span class="cstat-no" title="statement not covered" >    globalState.setPipelineErrors(pipelineErrors);</span>
<span class="cstat-no" title="statement not covered" >    globalState.setPipelineStats(pipelineStats);</span>
<span class="cstat-no" title="statement not covered" >    globalState.setPipelineStatsTotalSuccessCount(successCount);</span>
<span class="cstat-no" title="statement not covered" >    globalState.setPipelineStatsTotalErrorCount(errorCount);</span>
<span class="cstat-no" title="statement not covered" >    globalState.setPipelineStatsTotalDuration(totalDuration);</span>
<span class="cstat-no" title="statement not covered" >    globalState.setPipelineStatsTotalErrorDocIndices(errorDocIndices);</span>
<span class="cstat-no" title="statement not covered" >    globalState.setPipelineRunResults(lastSuccessfulResults);</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" >};</span>
&nbsp;
export const extractFields = <span class="fstat-no" title="function not covered" >(obj, parent) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >  let result = [];</span>
<span class="cstat-no" title="statement not covered" >  for (let key in obj) {</span>
<span class="cstat-no" title="statement not covered" >    if (Object.prototype.hasOwnProperty.call(obj, key)) {</span>
<span class="cstat-no" title="statement not covered" >      let newKey = parent ? `${parent}.${key}` : key;</span>
<span class="cstat-no" title="statement not covered" >      if (typeof obj[key] === 'object' &amp;&amp; obj[key] !== null) {</span>
<span class="cstat-no" title="statement not covered" >        result = result.concat(extractFields(obj[key], newKey));</span>
<span class="cstat-no" title="statement not covered" >      } else {</span>
<span class="cstat-no" title="statement not covered" >        const isEcs = Object.prototype.hasOwnProperty.call(ECS_FIELDS, newKey);</span>
<span class="cstat-no" title="statement not covered" >        const description = isEcs ? ECS_FIELDS[newKey] : '';</span>
<span class="cstat-no" title="statement not covered" >        result.push({</span>
<span class="cstat-no" title="statement not covered" >          field: newKey,</span>
<span class="cstat-no" title="statement not covered" >          is_ecs: isEcs,</span>
<span class="cstat-no" title="statement not covered" >          description: description,</span>
<span class="cstat-no" title="statement not covered" >          id: makeId(),</span>
<span class="cstat-no" title="statement not covered" >        });</span>
<span class="cstat-no" title="statement not covered" >      }</span>
<span class="cstat-no" title="statement not covered" >    }</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >  return result;</span>
<span class="cstat-no" title="statement not covered" >};</span>
&nbsp;
export const openAIRequest = <span class="fstat-no" title="function not covered" >async (vendor, product, textArray) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >  if (!vendor || !product || textArray.length === 0) return;</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >  const client = new OpenAIClient(aiEndpoint, new AzureKeyCredential(aiKey));</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >  let fullText = `Vendor: ${vendor}, Product: ${product}\n`;</span>
<span class="cstat-no" title="statement not covered" >  textArray.forEach((text, index) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    fullText += `Test Data ${index + 1}: ${text}\n`;</span>
<span class="cstat-no" title="statement not covered" >  });</span>
<span class="cstat-no" title="statement not covered" >  const allMessages = [</span>
<span class="cstat-no" title="statement not covered" >    ...messages,</span>
<span class="cstat-no" title="statement not covered" >    {</span>
<span class="cstat-no" title="statement not covered" >      role: 'user',</span>
<span class="cstat-no" title="statement not covered" >      content: fullText,</span>
<span class="cstat-no" title="statement not covered" >    },</span>
<span class="cstat-no" title="statement not covered" >  ];</span>
<span class="cstat-no" title="statement not covered" >  console.log('Sending API Request');</span>
<span class="cstat-no" title="statement not covered" >  const result = await client.getChatCompletions(aiEngine, allMessages, {</span>
<span class="cstat-no" title="statement not covered" >    maxTokens: parseInt(aiTokenLimit),</span>
<span class="cstat-no" title="statement not covered" >  });</span>
<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" >  const pipeline = extractPipeline(result?.choices[0]?.message?.content);</span>
<span class="cstat-no" title="statement not covered" >  let processedPipeline = null;</span>
<span class="cstat-no" title="statement not covered" >  try {</span>
<span class="cstat-no" title="statement not covered" >    processedPipeline = JSON.parse(pipeline);</span>
<span class="cstat-no" title="statement not covered" >  } catch (e) {</span>
<span class="cstat-no" title="statement not covered" >    console.log(e);</span>
<span class="cstat-no" title="statement not covered" >    return;</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" >  let items = [];</span>
<span class="cstat-no" title="statement not covered" >  processedPipeline.processors.forEach((item) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >    const key = makeId();</span>
<span class="cstat-no" title="statement not covered" >    const newProcessor = Object.keys(item)[0];</span>
<span class="cstat-no" title="statement not covered" >    const content = JSON.stringify(item, null, 2);</span>
<span class="cstat-no" title="statement not covered" >    const newItem = {</span>
<span class="cstat-no" title="statement not covered" >      key,</span>
<span class="cstat-no" title="statement not covered" >      newProcessor,</span>
<span class="cstat-no" title="statement not covered" >      content,</span>
<span class="cstat-no" title="statement not covered" >    };</span>
<span class="cstat-no" title="statement not covered" >    items.push(newItem);</span>
<span class="cstat-no" title="statement not covered" >  });</span>
<span class="cstat-no" title="statement not covered" >  globalState.setIngestPipelineState(items);</span>
<span class="cstat-no" title="statement not covered" >};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >function extractPipeline(str) {</span></span>
<span class="cstat-no" title="statement not covered" >  const matches = str.match(/```([^`]*)```/);</span>
<span class="cstat-no" title="statement not covered" >  return matches &amp;&amp; matches[1] ? matches[1] : null;</span>
<span class="cstat-no" title="statement not covered" >}</span>
&nbsp;</pre></td></tr></table></pre>

                <div class='push'></div><!-- for sticky footer -->
            </div><!-- /wrapper -->
            <div class='footer quiet pad2 space-top1 center small'>
                Code coverage generated by
                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
                at 2023-07-04T14:45:51.558Z
            </div>
        <script src="../prettify.js"></script>
        <script>
            window.onload = function () {
                prettyPrint();
            };
        </script>
        <script src="../sorter.js"></script>
        <script src="../block-navigation.js"></script>
    </body>
</html>
    